---
id: mock-registry
title: Mock 注册中心
sidebar_label: Mock 注册中心 📦
tags:
  - 说明文档
  - 功能指南
  - 模拟存储
keywords:
  - 模拟存储
  - keploy 云服务
  - 高效测试
  - 云存储
---

Mock 注册中心将模拟文件上传至云存储，保持应用仓库的轻量化和可管理性。

在测试过程中处理大型模拟文件时，将其提交到 git 仓库可能十分繁琐。**将这些模拟文件上传至云存储**有助于保持仓库的整洁和高效，降低复杂度。

## 使用方法 🛠️

### 禁用模拟上传

默认情况下，模拟文件会被`自动上传至云端`，可通过 CLI 或 keploy 配置文件禁用此功能。

1. [通过 CLI 参数禁用](#通过-cli-参数禁用)
2. [通过 keploy 配置文件禁用](#通过-keploy-配置文件禁用)

### 通过 CLI 参数禁用

要为特定测试运行禁用模拟上传，使用 --disableMockUpload=true 参数：

```bash
keploy test -c "<应用命令>" --disableMockUpload=true
```

### 通过 keploy 配置文件禁用

在配置文件中设置模拟上传偏好，可为所有测试运行默认启用或禁用模拟上传：

```bash
# keploy.yaml
disableMockUpload: true
```

## Mock 注册中心行为

### 测试运行通过 ✅

如果测试用例通过，模拟文件将被上传至云端，添加到 .gitignore 文件，并生成包含唯一 Mock ID 的 config.yml 文件。

### 测试运行失败 ❌

如果一个或多个测试用例失败，模拟文件不会被上传至云端且不会生成 `config.yml` 文件，但模拟文件仍会被移入 `.gitignore`。

### 本地模拟文件缺失 🚫

如果本地缺少模拟文件，在测试运行时会从云端下载。

### 本地与云端模拟文件不同 🔄

如果本地和云端同时存在不同版本的模拟文件，测试运行时会下载并使用云端版本。

### 上传更新后的模拟文件 📤

要更新云端的模拟文件，删除测试集文件夹下的 `config.yml` 文件。运行测试时会生成新的配置文件，更新后的模拟文件将被上传至云端。

### 使用 `--removeUnuseMocks` 参数时 🧹

当使用 `--removeUnusedMocks` 参数时，`config.yml` 会更新为新的 Mock ID，这些模拟文件将被视为新文件。

### 公共与私有模拟文件 🔒

根据使用场景和访问权限，模拟文件可分为公共和私有两类：

#### 公共模拟文件 🌐

所有用户均可访问公共模拟文件，并可在多个项目间共享。当数据具有通用性且不敏感时使用公共模拟文件。

#### 私有模拟文件 🔐

私有模拟文件仅限特定用户或项目访问。处理敏感数据或项目专属数据时使用私有模拟文件，确保安全性和隐私性。